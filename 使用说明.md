## TuanZiSDK1.0使用说明

###  文档变更和修订历史记录
版本号  | 修改日期 | 修改记录 |修改人
---     |---       |---       | ---
V1.0    |2019/07/28 |新增     | 杨振东



### 1、SDK的集成
#### 1.1 SDK版本和支持说明
1.身份证OCR的SDK版本为MegIDCardQuality 1.4.0A[联网授权版本]；

2.活体人脸认证的SDK版本为MegLiveStill-3.1.10；

3.魔蝎的SDK版本为2.4.4；

4.同盾的SDK版本为3.2.1

#### 1.2 SDK包目录说明
#### 1.3 SDK的集成步骤
1.添加SDK .aar库：将library-debug.aar放到工程libs目录下，
在项目project/build.gradle中，添加
```
repositories {
    maven { url "http://company.yingzhongshare.com:1211/Don/TuanZiAAR/raw/master/" }
}
```
在项目model/build.gradle中，添加
```
     implementation 'tuanzi.lib:aar:1.0.0-SNAPSHOT'
```
#### 1.4 SDK的初始化
1.SDK的初始化
```
/**
* SDK的初始化，传入相应的pheadjson,appKey,魔蝎Key,UUID,是否测试服务器isTestVersion
* 是否debug模式，是否打开日志等。具体可以根据所需的SDK传入初始化的值
*/
LoanHomeLib loanHomeLib = new LoanHomeLib.LoanHomeBuilder(this)
                .setpheadjson(pheadjson) //必传
                .setappKey("") //调用魔蝎SDK时必传
                .setmoxieKey("")//调用魔蝎SDK时必传
                .setuuid("")//调用OCR的SDK时必传必传
                .setisTestVersion(true)//必传
                .setisDebug(true)//必传
                .setenableLog(true)//必传
                .build();
```
2.调用身份证OCR SDK
2.1 调用OCR联网授权（必须），可提前进行联网授权；
```
IDCarcdDetectUtil idCarcdDetectUtil =new IDCarcdDetectUtil();
idCarcdDetectUtil.getOCRLiscense(context);
```
2.2 调用身份证OCR
```
IDCarcdDetectUtil idCarcdDetectUtil =new IDCarcdDetectUtil();
VerifyInfo verifyInfo =new VerifyInfo();
verifyInfo.setCameraType(side);//必传，设置调用身份证OCR的正/反面，0为正面，1为反面
verifyInfo.setNeedCallBackBack(true);//必传，设置是否需要背面OCR结果回调；
verifyInfo.setNeedCallBackFront(true);//必传，设置是否需要正面OCR结果回调；
idCarcdDetectUtil.setInfo(verifyInfo);
idCarcdDetectUtil.gotoIDCardDetect(context,new VerifyResultCallback() {
            @Override
            public void onVerifySuccess(String result) {
                Log.i(TAG, "onVerifySuccess: "+result.toString());
                //成功的回调
                //todo code 
            }

            @Override
            public void onVerifyWaitConfirm() {

            }

            @Override
            public void onVerifyFail(String type) {
                //失败的回调
                //todo code 
            }

            @Override
            public void onVerifyCancel() {
                //取消的回调
                //todo code 
            }

            @Override
            public void onVerifyStart() {

            }
        });
```
3.调用银行卡OCR
```
OCRBankCardUtil ocrBankCardUtil = new OCRBankCardUtil();
        VerifyInfo verifyInfo = new VerifyInfo();
        verifyInfo.setIdCardName("");//必传 身份证名字 
        verifyInfo.setIdCardNumber("");
        ocrBankCardUtil.setInfo(verifyInfo);
        ocrBankCardUtil.gotoBankCardDetect(this, new VerifyResultCallback() {
            @Override
            public void onVerifySuccess(String result) {
                //成功的回调
                //todo code
            }

            @Override
            public void onVerifyWaitConfirm() {

            }

            @Override
            public void onVerifyFail(String type) {
                //失败的回调
                //todo code 
            }

            @Override
            public void onVerifyCancel() {
                 //取消的回调
                //todo code 
            }

            @Override
            public void onVerifyStart() {

            }
        });
```
4.调用活体人脸认证SDK
```
 LivenessUtil livenessUtil =new LivenessUtil();

VerifyInfo verifyInfo = new VerifyInfo();
verifyInfo.setIdCardName(""); //必传，设置身份证名字
verifyInfo.setIdCardNumber("");//必传，设置身份证号码
livenessUtil.setInfo(verifyInfo);
livenessUtil.getBizToken(context,new VerifyResultCallback() {
            @Override
            public void onVerifySuccess(String result) {
                Log.i(TAG, "onVerifySuccess: "+result.toString());
                //成功的回调
                //todo code 
            }

            @Override
            public void onVerifyWaitConfirm() {

            }

            @Override
            public void onVerifyFail(String type) {
                //失败的回调
                //todo code 
            }

            @Override
            public void onVerifyCancel() {
                //取消的回调
                //todo code 
            }

            @Override
            public void onVerifyStart() {

            }
        });
```
5.调用魔蝎SDK-刷新账单
```
 MoXieUtil moXieUtil =new MoXieUtil();
String task = "bank"; //必传，声明类型 bank为网银导入，email为邮箱导入

TaskInfo taskInfo =new TaskInfo();
taskInfo.setLoginCode("CMB"); //设置直达指定银⾏
taskInfo.setLoginTarget("CREDITCARD");//信⽤卡
taskInfo.setLoginType("IDCARD");
taskInfo.setAccount("");
taskInfo.setPassword("");

moXieUtil.gotoMoXie(this, task, taskInfo, new MoxieResultCallback() {

            @Override
            public void onSuccess(String action) {
                //成功的回调
                //todo code 
            }

            @Override
            public void onFailed() {
                //失败的回调
                //todo code 
            }

            @Override
            public void onProgress() {
                Log.i(TAG, "onProgress: ");
            }
        });
```
6.调用同盾SDK
```
TongDunUtil tongDunUtil =new TongDunUtil();
tongDunUtil.intitTongDunSDK(MainActivity.this, new TongDunResultCallback() {

            @Override
            public void onSuccess(String data) {
                //成功的回调
                //todo code 
            }

            @Override
            public void onFailed() {
                //失败的回调
                //todo code 
            }

            @Override
            public void onProgress() {

            }
        });
```









